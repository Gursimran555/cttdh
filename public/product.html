<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Product Details</title>
  <script src="https://cdn.tailwindcss.com"></script>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">


  <style>
    /* cormorant-garamond-latin-400-normal */
    @font-face {
      font-family: 'Cormorant Garamond';
      font-style: normal;
      font-display: swap;
      font-weight: 400;
      src: url(https://cdn.jsdelivr.net/fontsource/fonts/cormorant-garamond@latest/latin-400-normal.woff2) format('woff2'), url(https://cdn.jsdelivr.net/fontsource/fonts/cormorant-garamond@latest/latin-400-normal.woff) format('woff');
      unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
    }
  </style>

  <style>
    body {
      font-family: 'Poppins', sans-serif;
    }

    .add-to-cart-btn {
      background-color: #FFA500;
      /* Autumn color */
      color: white;
      padding: 8px 16px;
      /* Smaller button */
      border-radius: 0px;
      font-size: 14px;
      font-weight: bold;
      display: flex;
      align-items: center;
      gap: 8px;
      transition: background-color 0.3s ease;
      width: fit-content;
      width: 500px;
      height: 60px;
      /* Make button fit content */
    }

    .add-to-cart-btn:hover {
      background-color: #FF8C00;
      /* Darker autumn color */
    }

    .size-btn {
      padding: 8px 16px;
      border: 2px solid #e2e8f0;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .size-btn.selected {
      border-color: #4CAF50;
      background-color: #f0fff4;
    }



    .related-product-card {
      transition: transform 0.3s ease, box-shadow 0.3s ease;

    }

    .related-product-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.15);
    }

    .related-product-card img {
      height: 600px;
      /* Adjusted height for related product images */
      object-fit: cover;
      cursor: pointer;
      /* Make image clickable */
    }



    .price-cut {
      text-decoration: line-through;
      color: #999;
      font-size: 16px;
    }

    .discount-badge {
      background-color: #FF4757;
      color: white;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 12px;
      margin-left: 8px;
    }

    #productImage {
      max-width: 90%;
      /* Adjust this value to your desired width */
      height: 90%;
      /* Maintain aspect ratio */
      border-radius: 0px;
      /* Optional: Adjust border radius */
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      /* Optional: Adjust shadow */
    }
  </style>
  <style>

  </style>


  <style>
    #prevImageButton,
    #nextImageButton {
      background-color: rgba(216, 208, 208, 0.8);
      padding: 20px;
      border-radius: 500px;
      box-shadow: 0 0px 0px rgba(0, 0, 0, 0.1);
      transition: background-color 0.3s ease;
    }

    #prevImageButton:hover,
    #nextImageButton:hover {
      background-color: rgb(155, 154, 154);
    }
  </style>



</head>

<body class="bg-gray-50 text-gray-900">
  <!-- Navigation -->
  <!-- Navigation -->
  <header class="bg-white shadow-lg fixed w-full z-10">
    <div class="container mx-auto px-6 py-4 flex justify-between items-center">
      <a href="/">
        <img src="./images/logo.png" alt="Autumn Logo" class="h-10">
      </a>

      <div class="flex space-x-4">
        <a id="loginButton" href="/auth.html" class="text-gray-700 hover:text-indigo-600 transition duration-300">
          <i class="fas fa-user text-2xl"></i> <!-- Updated icon -->
        </a>
        <a id="logoutButton" href="#" class="text-gray-700 hover:text-red-600 transition duration-300 hidden">
          <i class="fas fa-sign-out-alt text-2xl"></i>
        </a>
        <!-- Update the cart icon in the navbar -->
        <a href="/cart.html" class="text-gray-700 hover:text-green-600 transition duration-300 relative">
          <i class="fas fa-shopping-cart text-2xl"></i>
          <span id="cartCount"
            class="absolute top-0 right-0 bg-red-500 text-white text-xs rounded-full px-1.5 py-0.5 transform translate-x-1/2 -translate-y-1/2">0</span>
        </a>
        <a href="/wishlist.html" class="text-gray-700 hover:text-green-600 transition duration-300">
          <i class="fas fa-heart text-2xl"></i>
        </a>

      </div>
    </div>
  </header>
  <br><br>

  <!-- Product Details Section -->
  <div class="container mx-auto px-6 py-12">
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-12">
      <!-- Product Image -->
      <div class="flex justify-center relative">
        <img id="productImage" src="" alt="Product Image" class="w-full max-w-md h-auto rounded-lg shadow-lg"
          crossorigin="anonymous">

        <!-- Previous Image Button -->
        <button id="prevImageButton"
          class="absolute left-0 top-1/2 transform -translate-y-1/2 bg-white p-2 rounded-full shadow-md hover:bg-gray-100 transition-colors">
          <i class="fas fa-chevron-left text-gray-700"></i>
        </button>

        <!-- Next Image Button -->
        <button id="nextImageButton"
          class="absolute right-0 top-1/2 transform -translate-y-1/2 bg-white p-2 rounded-full shadow-md hover:bg-gray-100 transition-colors">
          <i class="fas fa-chevron-right text-gray-700"></i>
        </button>
      </div>

      <!-- Product Information -->
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-12">
        <div>
          <h1 id="productName" class="text-4xl font-bold text-gray-800 mb-4"></h1>
          <p id="productDescription" class="text-gray-600 mb-6"></p>
          <div class="flex items-center gap-4 mb-6">
            <span id="originalPrice" class="price-cut"></span>
            <span id="productPrice" class="text-3xl font-bold text-green-500"></span>
            <span class="discount-badge">20% off</span>
          </div>

          <!-- Size Selection -->
          <div class="mb-6">
            <label class="block text-gray-700 font-medium mb-2">Size:</label>
            <div class="flex gap-2">
              <button class="size-btn" data-size="S">S</button>
              <button class="size-btn" data-size="M">M</button>
              <button class="size-btn" data-size="L">L</button>
              <button class="size-btn" data-size="XL">XL</button>
            </div>
            <!-- Add this line to display the model's size -->
            <p id="modelSize" class="text-sm text-gray-600 mt-2">Model is wearing size: <span
                id="modelSizeValue"></span></p>
          </div>

          <!-- Size Guide Button and Chart -->
          <div class="mb-6">
            <button id="sizeGuideButton" class="mt-4 text-blue-600 hover:text-blue-800 underline focus:outline-none">
              Size Guide
            </button>
            <div id="sizeChartTable" class="mt-4 hidden">
              <img id="sizeChartImage" src="" alt="Size Chart" class="w-full max-w-md h-auto rounded-lg shadow-lg">
            </div>
          </div>

          <!-- Quantity Selector -->
          <div class="mb-6">
            <label for="quantity" class="block text-gray-700 font-medium mb-2">Quantity:</label>
            <input type="number" id="quantity" name="quantity" min="1" value="1"
              class="w-24 px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500">
          </div>

          <div class="flex items-center space-x-2">
            <!-- Add to Cart Button -->
            <button id="addToCartButton" class="add-to-cart-btn">
              <i class="fas fa-shopping-cart"></i> Add to Cart
            </button>

            <!-- Add to Wishlist Button -->
            <button id="addToWishlistButton"
              class="add-to-cart-btn bg-yellow-100 text-yellow-800 border border-yellow-600 hover:bg-yellow-200">
              <i class="fas fa-heart"></i> Add to Wishlist
            </button>
          </div>



          <!-- Add the event listener for the wishlist button -->
          <script>
            const addToWishlistButton = document.getElementById('addToWishlistButton');

            addToWishlistButton.onclick = () => {
              const token = localStorage.getItem('token');
              if (!token) {
                alert('Please login to add items to your wishlist.');
                window.location.href = '/auth.html';
                return;
              }

              fetch('/wishlist', {
                method: 'POST',
                headers: {
                  'Content-Type': 'application/json',
                  Authorization: `Bearer ${token}`,
                },
                body: JSON.stringify({ productId }),
              })
                .then(res => res.json())
                .then(data => {
                  if (data.success) {
                    alert('Item added to wishlist!');
                  } else {
                    alert('Failed to add item to wishlist.');
                  }
                })
                .catch(err => console.error('Error adding item to wishlist:', err));
            };
          </script>
        </div>

        <!-- Key Features Section -->
        <div id="keyFeatures" class="key-features">
          <h3>Key Features</h3>
          <ul id="keyFeaturesList"></ul>
        </div>

        <!-- FontAwesome for Icons -->
        <script src="https://kit.fontawesome.com/your-fontawesome-kit.js" crossorigin="anonymous"></script>

        <style>
          /* Key Features Section */
          .key-features {
            margin-top: 20px;
            padding: 32px;
            background: #ffffff;
            border-radius: 16px;
            border: 1px solid #d97706;
            /* Dark Yellow Border */
            transition: all 0.3s ease-in-out;
            text-align: center;
          }

          .key-features:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
          }

          .key-features h3 {
            font-size: 24px;
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 24px;
            text-transform: uppercase;
            letter-spacing: 1.2px;
            position: relative;
            display: inline-block;
          }

          .key-features h3::after {
            content: '';
            display: block;
            width: 60px;
            height: 3px;
            background: #4CAF50;
            margin: 8px auto 0;
            border-radius: 2px;
          }

          .key-features ul {
            list-style: none;
            padding: 0;
            display: flex;
            flex-direction: column;
            gap: 16px;
          }

          .key-features li {
            background: #f9fafb;
            padding: 8px 10px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            gap: 16px;
            font-size: 16px;
            font-weight: 500;
            color: #374151;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
          }

          .key-features li:hover {
            background: #f3f4f6;
            transform: translateX(8px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
          }

          .key-features li i {
            font-size: 12px;
            color: #4CAF50;
            min-width: 30px;
            text-align: center;
          }

          /* Responsive Design */
          @media (max-width: 768px) {
            .key-features {
              padding: 24px;
            }

            .key-features h3 {
              font-size: 22px;
            }

            .key-features li {
              padding: 14px 16px;
              font-size: 15px;
            }

            .key-features li i {
              font-size: 22px;
            }
          }
        </style>



      </div>
    </div>
  </div>

  <!-- Compact and Modern Services Section -->
  <div class="bg-white p-6 rounded-xl shadow-lg mb-8 max-w-4xl mx-auto">
    <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
      <!-- Free Delivery -->
      <div class="flex items-center gap-3 p-4 bg-gray-50 rounded-lg hover:shadow-md transition-all duration-300">
        <div class="p-2 bg-green-100 rounded-lg">
          <i class="fas fa-truck text-xl text-green-600"></i>
        </div>
        <div>
          <h3 class="text-sm font-semibold text-gray-800">Free Delivery</h3>
          <p class="text-xs text-gray-500">Above ₹499</p>
        </div>
      </div>

      <!-- Exchange Offer -->
      <div class="flex items-center gap-3 p-4 bg-gray-50 rounded-lg hover:shadow-md transition-all duration-300">
        <div class="p-2 bg-blue-100 rounded-lg">
          <i class="fas fa-exchange-alt text-xl text-blue-600"></i>
        </div>
        <div>
          <h3 class="text-sm font-semibold text-gray-800">Easy Exchange</h3>
          <p class="text-xs text-gray-500">Hassle-free</p>
        </div>
      </div>

      <!-- Replacement Offer -->
      <div class="flex items-center gap-3 p-4 bg-gray-50 rounded-lg hover:shadow-md transition-all duration-300">
        <div class="p-2 bg-purple-100 rounded-lg">
          <i class="fas fa-sync-alt text-xl text-purple-600"></i>
        </div>
        <div>
          <h3 class="text-sm font-semibold text-gray-800">Quick Replacement</h3>
          <p class="text-xs text-gray-500">No delays</p>
        </div>
      </div>

      <!-- Cash on Delivery -->
      <div class="flex items-center gap-3 p-4 bg-gray-50 rounded-lg hover:shadow-md transition-all duration-300">
        <div class="p-2 bg-orange-100 rounded-lg">
          <i class="fas fa-money-bill-wave text-xl text-orange-600"></i>
        </div>
        <div>
          <h3 class="text-sm font-semibold text-gray-800">Cash on Delivery</h3>
          <p class="text-xs text-gray-500">Pay on delivery</p>
        </div>
      </div>
    </div>
    <div class="mt-4 flex items-center justify-center">
      <a href="./policies.html" class="text-blue-600 underline hover:text-blue-800">
        Terms and Conditions applied
      </a>
    </div>

  </div>



  <!-- Related Products Section -->
  <div class="mt-16">
    <h2 class="text-3xl font-bold text-gray-800 mb-8">Related Products</h2>
    <div id="relatedProducts" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4">
      <!-- Related products will be dynamically loaded here -->
    </div>
  </div>
  </div>

  <!-- Customer Reviews Section -->
  <!-- Customer Reviews Section -->
  <div class="mt-16">
    <h2 class="text-3xl font-bold text-gray-800 mb-8">Customer Reviews</h2>
    <div id="reviews" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
      <!-- Reviews will be dynamically loaded here -->
    </div>

    <!-- Review Form -->
    <form id="reviewForm" class="mt-8 bg-white p-8 rounded-2xl shadow-xl max-w-lg mx-auto">
      <h3 class="text-2xl font-bold text-gray-900 mb-5 text-center">Write a Review</h3>

      <textarea id="reviewText"
        class="w-full px-5 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-4 focus:ring-blue-400 transition-shadow"
        placeholder="Share your thoughts..." required></textarea>

      <div class="mt-5 text-center">
        <label for="rating" class="block text-gray-800 font-medium mb-3">Rating:</label>
        <div class="flex justify-center gap-3">
          <button type="button" class="rating-btn text-gray-400 text-2xl hover:text-yellow-500 transition"
            data-rating="1"><i class="fas fa-star"></i></button>
          <button type="button" class="rating-btn text-gray-400 text-2xl hover:text-yellow-500 transition"
            data-rating="2"><i class="fas fa-star"></i></button>
          <button type="button" class="rating-btn text-gray-400 text-2xl hover:text-yellow-500 transition"
            data-rating="3"><i class="fas fa-star"></i></button>
          <button type="button" class="rating-btn text-gray-400 text-2xl hover:text-yellow-500 transition"
            data-rating="4"><i class="fas fa-star"></i></button>
          <button type="button" class="rating-btn text-gray-400 text-2xl hover:text-yellow-500 transition"
            data-rating="5"><i class="fas fa-star"></i></button>
        </div>
        <input type="hidden" id="rating" name="rating" required>
      </div>
      <br>

      <button type="submit"
        class="mt-6 w-full bg-gradient-to-r from-blue-500 to-indigo-500 text-white px-6 py-3 rounded-xl font-semibold hover:opacity-90 transition duration-300 shadow-md">
        Submit Review
      </button>
    </form>
  </div>
  


  <footer class="bg-amber-50 border-t-4 border-amber-200 shadow-lg">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-12">
      <div class="grid grid-cols-1 md:grid-cols-5 gap-8 lg:gap-12">
        <!-- Brand Section -->
        <div class="md:col-span-2">
          <h3 class="text-2xl font-bold text-amber-900 mb-4">Autumn T-Shirts</h3>
          <p class="text-amber-700 text-sm leading-relaxed">
            Embrace seasonal style with our curated collection of autumn-inspired apparel.
            Where comfort meets trend in every stitch.
          </p>

        </div>

        <!-- Quick Links -->
        <div>
          <h4 class="text-amber-900 font-semibold mb-4 text-lg">Explore</h4>
          <ul class="space-y-2">
            <li><a href="#" class="text-amber-700 hover:text-amber-900 transition-colors">Men's Collection</a></li>
            <li><a href="#" class="text-amber-700 hover:text-amber-900 transition-colors">Women's Styles</a></li>
          </ul>
        </div>

        <!-- Support -->
        <div>
          <h4 class="text-amber-900 font-semibold mb-4 text-lg">Support</h4>
          <ul class="space-y-2">

            <li><a href="./policies.html" class="text-amber-700 hover:text-amber-900 transition-colors">Terms and
                conditions</a></li>
            <li><a href="./contact-support.html" class="text-amber-700 hover:text-amber-900 transition-colors">Contact
                Support</a></li>
            <li><a href="./report-bug.html" class="text-amber-700 hover:text-amber-900 transition-colors">Report a Bug
              </a></li>
          </ul>
        </div>

        <!-- Contact -->
        <div>
          <h4 class="text-amber-900 font-semibold mb-4 text-lg">Connect</h4>
          <div class="space-y-2">
            <div class="flex items-center gap-2">
              <svg class="w-5 h-5 text-amber-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
              </svg>
              <span class="text-amber-700">support@autumnindia.com</span>
            </div>
            <div class="flex items-center gap-2">
              <svg class="w-5 h-5 text-amber-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
              </svg>
              <span class="text-amber-700">+91 8354926995</span>
            </div>
          </div>

          <!-- Social Icons -->
          <div class="mt-4 flex gap-3">
            <a href="#" class="p-2 bg-amber-100 rounded-full hover:bg-amber-200 transition-colors">
              <svg class="w-5 h-5 text-amber-700" fill="currentColor" viewBox="0 0 24 24">
                <path
                  d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z" />
              </svg>
            </a>
            <a href="#" class="p-2 bg-amber-100 rounded-full hover:bg-amber-200 transition-colors">
              <svg class="w-5 h-5 text-amber-700" fill="currentColor" viewBox="0 0 24 24">
                <path
                  d="M12 0c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm3 8h-1.35c-.538 0-.65.221-.65.778v1.222h2l-.209 2h-1.791v7h-3v-7h-2v-2h2v-2.308c0-1.769.931-2.692 3.029-2.692h1.971v3z" />
              </svg>
            </a>
            <a href="https://www.instagram.com/autumn_official_?igsh=bzQ1emY2OXZlbXNk&utm_source=qr" class="p-2 bg-amber-100 rounded-full hover:bg-amber-200 transition-colors">
              <svg class="w-5 h-5 text-amber-700" fill="currentColor" viewBox="0 0 24 24">
                <path
                  d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z" />
              </svg>
            </a>
          </div>
        </div>
      </div>

      <!-- Copyright -->
      <div class="mt-12 pt-8 border-t border-amber-200 text-center">
        <p class="text-sm text-amber-600">
          © 2025 Autumn Styles.
        </p>
      </div>
    </div>
  </footer>

  <script defer>
    const productImage = document.getElementById('productImage');
    const prevImageButton = document.getElementById('prevImageButton');
    const nextImageButton = document.getElementById('nextImageButton');
    const productName = document.getElementById('productName');
    const productDescription = document.getElementById('productDescription');
    const productPrice = document.getElementById('productPrice');
    const originalPrice = document.getElementById('originalPrice');
    const addToCartButton = document.getElementById('addToCartButton');
    const reviewsContainer = document.getElementById('reviews');
    const reviewForm = document.getElementById('reviewForm');
    const relatedProductsContainer = document.getElementById('relatedProducts');
    const sizeButtons = document.querySelectorAll('.size-btn');
    const ratingButtons = document.querySelectorAll('.rating-btn');
    const keyFeaturesList = document.getElementById('keyFeaturesList');

    let selectedSize = null;
    let selectedRating = 0;
    let productImages = []; // Array to store multiple images
    let currentImageIndex = 0; // Index of the currently displayed image

    // Get the product ID from the query string
    const params = new URLSearchParams(window.location.search);
    const productId = params.get('id');

    // Fetch and display product details
    // Fetch and display product details
    fetch(`/product/${productId}`)
      .then(res => res.json())
      .then(product => {
        // Combine image URLs into an array, filtering out null values
        productImages = [product.image_url, product.image_url2, product.image_url3].filter(url => url);

        // Display the first image
        productImage.src = productImages[currentImageIndex];

        // Update product details
        productName.textContent = product.name;
        productDescription.textContent = product.description;
        const discountedPrice = product.price;
        const originalPriceValue = Math.round(discountedPrice * 1.25); // Add 25% to show discount
        originalPrice.textContent = `₹${originalPriceValue}`;
        productPrice.textContent = `₹${discountedPrice}`;

        // Display key features
        if (product.key_features) {
          const features = product.key_features.split(';');
          keyFeaturesList.innerHTML = features.map(feature => `
        <li>
          <i class="fas fa-check-circle"></i> ${feature}
        </li>
      `).join('');
        }

        // Display size chart image if available
        const sizeChartImage = document.getElementById('sizeChartImage');
        if (product.size_chart) {
          sizeChartImage.src = product.size_chart;
        } else {
          // Hide the size chart button if no size chart is available
          document.getElementById('sizeGuideButton').style.display = 'none';
        }

        // Display model's size
        const modelSizeElement = document.getElementById('modelSizeValue');
        if (product.model_size) {
          modelSizeElement.textContent = product.model_size; // Set the model size value
        } else {
          document.getElementById('modelSize').style.display = 'none'; // Hide if no model size is available
        }

        // Stock Status Logic
        const stockStatus = document.createElement('div');
        stockStatus.className = 'absolute top-2 left-30 bg-white p-2 rounded-full shadow-md';
        if (product.quantity > 0) {
          stockStatus.textContent = 'In Stock';
          stockStatus.classList.add('text-green-500');
          if (product.quantity < 3) {
            stockStatus.textContent = 'Only Few Items Left';
            stockStatus.classList.add('text-yellow-500');
          }
        } else {
          stockStatus.textContent = 'Out of Stock';
          stockStatus.classList.add('text-red-500');
          addToCartButton.disabled = true;
          addToCartButton.textContent = 'Item Out of Stock';
          addToCartButton.classList.remove('bg-blue-500', 'hover:bg-blue-600');
          addToCartButton.classList.add('bg-gray-400', 'cursor-not-allowed');
        }

        // Append stock status to the image container
        const imageContainer = document.querySelector('.flex.justify-center.relative');
        imageContainer.appendChild(stockStatus);

        // Handle add to cart button click
        addToCartButton.onclick = () => {
          if (!selectedSize) {
            return;
          }
          if (product.quantity < 1) {
            alert('Item is out of stock.');
            return;
          }
          addToCart(productId);
        };
      });

    // Handle next image button click
    nextImageButton.addEventListener('click', () => {
      currentImageIndex = (currentImageIndex + 1) % productImages.length; // Cycle to next image
      productImage.src = productImages[currentImageIndex];
    });

    // Handle previous image button click
    prevImageButton.addEventListener('click', () => {
      currentImageIndex = (currentImageIndex - 1 + productImages.length) % productImages.length; // Cycle to previous image
      productImage.src = productImages[currentImageIndex];
    });

    // Fetch and display reviews
    fetch(`/product/${productId}/reviews`)
      .then(res => res.json())
      .then(reviews => {
        reviewsContainer.innerHTML = reviews.map(review => `
      <div class="review-card bg-white p-6 rounded-lg shadow-md hover:shadow-lg transition-shadow">
        <div class="flex items-center gap-4 mb-4">
          <div class="w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center">
            <i class="fas fa-user text-2xl text-gray-500"></i> <!-- User icon -->
          </div>
          <div>
            <p class="text-gray-700 font-semibold">${review.users.full_name}</p> 
            <div class="star-rating text-yellow-400">
              ${Array.from({ length: review.rating }, (_, i) => `<i class="fas fa-star"></i>`).join('')}
            </div>
          </div>
        </div>
        <p class="text-gray-600">${review.text}</p>
      </div>
    `).join('');
      });

    // Fetch and display related products
    fetch(`/products?limit=4`)
      .then(res => res.json())
      .then(products => {
        relatedProductsContainer.innerHTML = products.map(product => {
          const discountedPrice = product.price;
          const originalPriceValue = Math.round(discountedPrice * 1.25); // Add 25% to show discount
          return `
            <div class="related-product-card bg-white rounded-lg shadow-lg p-6">
              <img src="${product.image_url}" alt="${product.name}" class="w-full h-full object-cover rounded-lg mb-4 cursor-pointer" onclick="window.location.href='/product.html?id=${product.id}'">
              <h3 class="text-xl font-semibold text-gray-800">${product.name}</h3>
              <div class="flex items-center gap-4 mt-2">
                <span class="price-cut">₹${originalPriceValue}</span>
                <span class="text-green-500 font-bold">₹${discountedPrice}</span>
                <span class="discount-badge">20% off</span>
              </div>
              <button onclick="window.location.href='/product.html?id=${product.id}'" class="view-details-btn mt-4 w-full">
                <i class="fas fa-eye"></i> View Details
              </button>
            </div>
          `;
        }).join('');
      });

    // Handle size selection
    sizeButtons.forEach(button => {
      button.addEventListener('click', () => {
        sizeButtons.forEach(btn => btn.classList.remove('selected'));
        button.classList.add('selected');
        selectedSize = button.getAttribute('data-size');
      });
    });

    // Handle rating selection
    ratingButtons.forEach(button => {
      button.addEventListener('click', () => {
        selectedRating = button.getAttribute('data-rating');
        ratingButtons.forEach(btn => btn.classList.remove('bg-yellow-400'));
        button.classList.add('bg-yellow-400');
        document.getElementById('rating').value = selectedRating;
      });
    });

    // Handle review submission
    reviewForm.addEventListener('submit', function (e) {
      e.preventDefault();
      const reviewText = document.getElementById('reviewText').value;
      const rating = document.getElementById('rating').value;

      fetch(`/product/${productId}/reviews`, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          Authorization: `Bearer ${localStorage.getItem('token')}`
        },
        body: JSON.stringify({ text: reviewText, rating: parseInt(rating) })
      })
        .then(res => res.json())
        .then(data => {
          if (data.success) {
            alert('Review submitted successfully!');
            window.location.reload();
          } else {
            alert('Failed to submit review. Please try again.');
          }
        })
        .catch(err => console.error('Error submitting review:', err));
    });

    
  </script>

  <script>
    // Toggle Size Chart Visibility
    const sizeGuideButton = document.getElementById('sizeGuideButton');
    const sizeChartTable = document.getElementById('sizeChartTable');

    sizeGuideButton.addEventListener('click', () => {
      sizeChartTable.classList.toggle('hidden');
    });
  </script>

  <style>
    /* Review Card Styling */
    .review-card {
      background-color: white;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .review-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.15);
    }

    .star-rating {
      color: #fbbf24;
    }

    /* User Icon Styling */
    .fa-user {
      font-size: 24px;
      color: #6b7280;
    }
  </style>
  <style>
    @media (max-width: 768px) {
      #productImage {
        width: 100%;
        /* Full width of the device */
        height: auto;
        /* Height will adjust according to the aspect ratio */
        max-width: 100%;
        /* Ensure it doesn't exceed the device width */
        max-height: 100%;
        /* Ensure it doesn't exceed the device height */
        border-radius: 0px;
        /* Optional: Adjust border radius */
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        /* Optional: Adjust shadow */
      }
    }
  </style>
  <script>
    // Function to update the cart count in the navbar
    function updateCartCount(count) {
      const cartCountElement = document.getElementById('cartCount');
      if (cartCountElement) {
        cartCountElement.textContent = count;
      }
    }

    // Fetch cart data and update the count
    async function fetchCart() {
      try {
        const token = localStorage.getItem('token');
        if (!token) {
          throw new Error('No token found');
        }

        const response = await fetch('/cart', {
          headers: { Authorization: `Bearer ${token}` }
        });

        if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);

        const cartData = await response.json();

        // Update the cart count in the navbar
        updateCartCount(cartData.length);
      } catch (error) {
        console.error('Fetch error:', error);
        // If the user is not logged in, the cart count will remain 0
      }
    }

    

    // Initial load
    document.addEventListener('DOMContentLoaded', () => {
      fetchCart();
    });
  </script>
  <script>
    document.addEventListener("DOMContentLoaded", () => {
    let selectedSize = null; // Store selected size

    // Add event listeners to size buttons
    document.querySelectorAll(".size-btn").forEach(button => {
        button.addEventListener("click", function () {
            // Remove selected class from all buttons
            document.querySelectorAll(".size-btn").forEach(btn => btn.classList.remove("selected"));

            // Add selected class to clicked button
            this.classList.add("selected");

            // Store selected size
            selectedSize = this.getAttribute("data-size");
        });
    });

    document.getElementById("addToCartButton").addEventListener("click", async () => {
        if (!selectedSize) {
            alert("Please select a size before adding to cart.");
            return;
        }

        const productId = window.location.search.split("=")[1];
        const quantity = document.getElementById("quantity").value;

        const token = localStorage.getItem("token");
        if (!token) {
            alert("Please log in to add items to the cart.");
            window.location.href = '/auth.html';
            return;
        }

        const response = await fetch("/cart", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
                "Authorization": `Bearer ${token}`
            },
            body: JSON.stringify({
                productId,
                quantity: parseInt(quantity),
                size: selectedSize
            })
        });

        const data = await response.json();
        if (data.success) {
            alert("Item added to cart successfully!");
            window.location.href = "/cart.html";
        } else {
            alert("Failed to add item to cart.");
        }
    });
});

  </script>
</body>

</html>